{"title":"小程序视频封面，切换播放并显示封面","uid":"ef423aef0aaabd6ebda2b8c384fcffef","slug":"小程序视频封面，切换播放并显示封面","date":"2024-03-14T08:30:15.000Z","updated":"2024-03-14T09:10:06.561Z","comments":true,"path":"api/articles/小程序视频封面，切换播放并显示封面.json","keywords":null,"cover":null,"content":"<h1 id=\"小程序视频封面，切换播放并显示封面\"><a href=\"#小程序视频封面，切换播放并显示封面\" class=\"headerlink\" title=\"小程序视频封面，切换播放并显示封面\"></a>小程序视频封面，切换播放并显示封面</h1><ul>\n<li><h2 id=\"需求\"><a href=\"#需求\" class=\"headerlink\" title=\"需求\"></a>需求</h2><ol>\n<li><p>默认显示封面；</p>\n</li>\n<li><p>一个视频播放的时候，其他视频停止播放，并显示封面。</p>\n</li>\n</ol>\n</li>\n<li><h2 id=\"思路\"><a href=\"#思路\" class=\"headerlink\" title=\"思路\"></a>思路</h2><ol>\n<li><p>通过wx:if判断当前视频是否是播放的状态，如果是就显示视频，如果不是就隐藏视频；</p>\n</li>\n<li><p>点击封面的时候，获取到该视频的id，进行判断，如果当前没有视频播放，就把该视频设置为播放的状态；如果当前有视频播放，则停止当前播放的视频，再播放你点击的这个视频。</p>\n</li>\n</ol>\n</li>\n</ul>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;view <span class=\"keyword\">class</span>=<span class=\"string\">&quot;video_body&quot;</span>&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">view</span> <span class=\"attr\">wx:for</span>=<span class=\"string\">&quot;&#123;&#123;courseList&#125;&#125;&quot;</span> <span class=\"attr\">wx:for-item</span>=<span class=\"string\">&quot;course&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&#x27;course-pannle-item&#x27;</span> <span class=\"attr\">wx:for-index</span>=<span class=\"string\">&quot;idx&quot;</span> <span class=\"attr\">wx:key</span>=<span class=\"string\">&quot;index&quot;</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\"></span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">view</span> <span class=\"attr\">class</span>=<span class=\"string\">&#x27;video-item&#x27;</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\"></span></span><br><span class=\"line\"><span class=\"language-xml\">          <span class=\"tag\">&lt;<span class=\"name\">video</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;video&quot;</span> <span class=\"attr\">wx:if</span>=<span class=\"string\">&#x27;&#123;&#123;idx==playIndex&#125;&#125;&#x27;</span> <span class=\"attr\">id</span>=<span class=\"string\">&#x27;video&#123;&#123;idx&#125;&#125;&#x27;</span> <span class=\"attr\">autoplay</span>=<span class=\"string\">&#x27;&#123;&#123;true&#125;&#125;&#x27;</span> <span class=\"attr\">show-center-play-btn</span>=<span class=\"string\">&quot;&#123;&#123;false&#125;&#125;&quot;</span> <span class=\"attr\">src</span>=<span class=\"string\">&#x27;&#123;&#123;course.videoUrl&#125;&#125;&#x27;</span> <span class=\"attr\">controls</span>=<span class=\"string\">&quot;true&quot;</span> <span class=\"attr\">objectFit</span>=<span class=\"string\">&quot;cover&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">video</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\"></span></span><br><span class=\"line\"><span class=\"language-xml\">          <span class=\"tag\">&lt;<span class=\"name\">image</span> <span class=\"attr\">class</span>=<span class=\"string\">&#x27;video-cover video&#x27;</span> <span class=\"attr\">wx:if</span>=<span class=\"string\">&#x27;&#123;&#123;idx!=playIndex&#125;&#125;&#x27;</span> <span class=\"attr\">mode</span>=<span class=\"string\">&#x27;widthFix&#x27;</span> <span class=\"attr\">src</span>=<span class=\"string\">&#x27;&#123;&#123;course.coverUrl&#125;&#125;&#x27;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">image</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\"></span></span><br><span class=\"line\"><span class=\"language-xml\">          <span class=\"tag\">&lt;<span class=\"name\">image</span> <span class=\"attr\">class</span>=<span class=\"string\">&#x27;video-play-btn&#x27;</span> <span class=\"attr\">wx:if</span>=<span class=\"string\">&#x27;&#123;&#123;idx!=playIndex&#125;&#125;&#x27;</span> <span class=\"attr\">mode</span>=<span class=\"string\">&#x27;widthFix&#x27;</span> <span class=\"attr\">data-index</span>=<span class=\"string\">&#x27;&#123;&#123;idx&#125;&#125;&#x27;</span> <span class=\"attr\">bindtap</span>=<span class=\"string\">&#x27;videoPlay&#x27;</span> <span class=\"attr\">src</span>=<span class=\"string\">&#x27;/images/home/btn.png&#x27;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">image</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\"></span></span><br><span class=\"line\"><span class=\"language-xml\">          <span class=\"comment\">&lt;!-- &lt;text wx:if=&#x27;&#123;&#123;idx!=playIndex&#125;&#125;&#x27; class=&#x27;video-duration fs-28&#x27;&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"language-xml\"></span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"language-xml\">                  &#123;&#123;course.duration&#125;&#125;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"language-xml\"></span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"language-xml\">              &lt;/text&gt; --&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\"></span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;/<span class=\"name\">view</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\"></span></span><br><span class=\"line\"><span class=\"language-xml\">  <span class=\"tag\">&lt;/<span class=\"name\">view</span>&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">&lt;/view&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">data</span>: &#123;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">playIndex</span>: <span class=\"literal\">null</span>, <span class=\"comment\">//用于记录当前播放的视频的索引值</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">courseList</span>: [</span><br><span class=\"line\"></span><br><span class=\"line\">&#123;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">videoUrl</span>: <span class=\"string\">&#x27;https://fxmv3-asset.oss-cn-zhangjiakou.aliyuncs.com/132a004191990de6d1dde6379a56987b.mp4&#x27;</span>, <span class=\"comment\">//视频路径</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">coverUrl</span>: <span class=\"string\">&#x27;/images/home/1.png&#x27;</span>, <span class=\"comment\">//视频封面图</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">duration</span>: <span class=\"string\">&#x27;03:00&#x27;</span> <span class=\"comment\">//视频时长</span></span><br><span class=\"line\"></span><br><span class=\"line\">&#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">&#123;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">videoUrl</span>: <span class=\"string\">&#x27;https://fxmv3-asset.oss-cn-zhangjiakou.aliyuncs.com/bddfba680554409e47aeb653ec5d58af.mp4&#x27;</span>,</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">coverUrl</span>: <span class=\"string\">&#x27;/images/home/2.png&#x27;</span>,</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">duration</span>: <span class=\"string\">&#x27;04:45&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">]</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;,</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">videoPlay</span>: <span class=\"keyword\">function</span> (<span class=\"params\">e</span>) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> curIdx = e.<span class=\"property\">currentTarget</span>.<span class=\"property\">dataset</span>.<span class=\"property\">index</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 没有播放时播放视频</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> (!<span class=\"variable language_\">this</span>.<span class=\"property\">data</span>.<span class=\"property\">playIndex</span>) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable language_\">this</span>.<span class=\"title function_\">setData</span>(&#123;</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"attr\">playIndex</span>: curIdx</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> videoContext = wx.<span class=\"title function_\">createVideoContext</span>(<span class=\"string\">&#x27;video&#x27;</span> + curIdx); <span class=\"comment\">//这里对应的视频id</span></span><br><span class=\"line\"></span><br><span class=\"line\">videoContext.<span class=\"title function_\">play</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 有播放时先将prev暂停，再播放当前点击的current</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> videoContextPrev = wx.<span class=\"title function_\">createVideoContext</span>(<span class=\"string\">&#x27;video&#x27;</span> + <span class=\"variable language_\">this</span>.<span class=\"property\">data</span>.<span class=\"property\">playIndex</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">data</span>.<span class=\"property\">playIndex</span> != curIdx) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">videoContextPrev.<span class=\"title function_\">pause</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable language_\">this</span>.<span class=\"title function_\">setData</span>(&#123;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">playIndex</span>: curIdx</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> videoContextCurrent = wx.<span class=\"title function_\">createVideoContext</span>(<span class=\"string\">&#x27;video&#x27;</span> + curIdx);</span><br><span class=\"line\"></span><br><span class=\"line\">videoContextCurrent.<span class=\"title function_\">play</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n","text":"小程序视频封面，切换播放并显示封面 需求 默认显示封面； 一个视频播放的时候，其他视频停止播放，并显示封面。 思路 通过wx:if判断当前视频是否是播放的状态，...","permalink":"/post/小程序视频封面，切换播放并显示封面","photos":[],"count_time":{"symbolsCount":"2.9k","symbolsTime":"3 mins."},"categories":[{"name":"前端","slug":"前端","count":11,"path":"api/categories/前端.json"}],"tags":[{"name":"小程序","slug":"小程序","count":3,"path":"api/tags/小程序.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%B0%8F%E7%A8%8B%E5%BA%8F%E8%A7%86%E9%A2%91%E5%B0%81%E9%9D%A2%EF%BC%8C%E5%88%87%E6%8D%A2%E6%92%AD%E6%94%BE%E5%B9%B6%E6%98%BE%E7%A4%BA%E5%B0%81%E9%9D%A2\"><span class=\"toc-text\">小程序视频封面，切换播放并显示封面</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E9%9C%80%E6%B1%82\"><span class=\"toc-text\">需求</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%80%9D%E8%B7%AF\"><span class=\"toc-text\">思路</span></a></li></ol></li></ol>","author":{"name":"WuYa","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/53419296?v=4","link":"/","description":"一位正在记笔记的人","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"搜索框的防抖和节流","uid":"4c7ce13c917059478f31fe5eaf02636d","slug":"搜索框的防抖和节流","date":"2024-03-14T08:30:15.000Z","updated":"2024-03-14T08:40:47.520Z","comments":true,"path":"api/articles/搜索框的防抖和节流.json","keywords":null,"cover":null,"text":"搜索框的防抖和节流1，防抖闭包函数123456789101112131415161718192021222324252627282930313233343536...","permalink":"/post/搜索框的防抖和节流","photos":[],"count_time":{"symbolsCount":850,"symbolsTime":"1 mins."},"categories":[{"name":"前端","slug":"前端","count":11,"path":"api/categories/前端.json"}],"tags":[{"name":"Javascript","slug":"Javascript","count":4,"path":"api/tags/Javascript.json"}],"author":{"name":"WuYa","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/53419296?v=4","link":"/","description":"一位正在记笔记的人","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"时间格式化&指定几天前时间","uid":"c3a4e3c0eb5ef6020f00420943ce1aca","slug":"时间格式化&指定几天前时间","date":"2024-03-14T08:30:15.000Z","updated":"2024-03-14T08:38:07.272Z","comments":true,"path":"api/articles/时间格式化&指定几天前时间.json","keywords":null,"cover":null,"text":"时间格式化&指定几天前时间1，时间格式化123456789101112131415161718192021222324252627282930313233343...","permalink":"/post/时间格式化&指定几天前时间","photos":[],"count_time":{"symbolsCount":"1.2k","symbolsTime":"1 mins."},"categories":[{"name":"前端","slug":"前端","count":11,"path":"api/categories/前端.json"}],"tags":[{"name":"Javascript","slug":"Javascript","count":4,"path":"api/tags/Javascript.json"}],"author":{"name":"WuYa","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/53419296?v=4","link":"/","description":"一位正在记笔记的人","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}